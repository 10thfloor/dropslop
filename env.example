# Local development environment variables (backend)
#
# Usage:
#   cp env.example .env
#
# Notes:
# - `.env` is gitignored.
# - The backend loads `./.env` automatically in development via `src/lib/env-loader.ts`.

# -----------------------------------------------------------------------------
# Runtime / Logging
# -----------------------------------------------------------------------------
NODE_ENV=development
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Service Ports (defaults match Makefile)
# -----------------------------------------------------------------------------
API_PORT=3003
SSE_PORT=3004
RESTATE_PORT=9080

# -----------------------------------------------------------------------------
# Infrastructure
# -----------------------------------------------------------------------------
NATS_URL=nats://localhost:4222
RESTATE_INGRESS_URL=http://localhost:8080

# Optional Restate client tuning
RESTATE_TIMEOUT_MS=30000
RESTATE_API_TIMEOUT_MS=15000

# -----------------------------------------------------------------------------
# CORS (comma-separated)
# -----------------------------------------------------------------------------
CORS_ORIGINS=http://localhost:3005,http://localhost:3003,http://127.0.0.1:3005,http://127.0.0.1:3003

# -----------------------------------------------------------------------------
# Security / Secrets (safe defaults for local dev; CHANGE for production)
# -----------------------------------------------------------------------------
IP_HASH_SALT=dev-ip-hash-salt-change-me
PURCHASE_TOKEN_SECRET=dev-purchase-secret-change-in-prod
ADMIN_SECRET=dev-admin-secret-change-me

# -----------------------------------------------------------------------------
# Bot Mitigation
# -----------------------------------------------------------------------------
# Keep this low for local testing; increase in prod.
POW_DIFFICULTY=2
MIN_TRUST_SCORE=50

# Optional: enable FingerprintJS Pro verification
FINGERPRINT_API_KEY=

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=10
RATE_LIMIT_STRICT_WINDOW_MS=60000
RATE_LIMIT_STRICT_MAX_REQUESTS=5

# Set true for load testing (also used by `make backend-test`)
SKIP_RATE_LIMIT=false

# -----------------------------------------------------------------------------
# Queue (token sequencing)
# -----------------------------------------------------------------------------
QUEUE_ENABLED=true
QUEUE_ADMISSION_RATE=20
QUEUE_MAX_CONCURRENT=50
QUEUE_READY_WINDOW=30
QUEUE_MAX_AGE=10
QUEUE_MIN_BEHAVIOR_SCORE=30
QUEUE_ADMISSION_TICK_MS=1000

# -----------------------------------------------------------------------------
# Maintenance
# -----------------------------------------------------------------------------
ENABLE_PERIODIC_CLEANUP=true
CLEANUP_INTERVAL_MS=300000

# -----------------------------------------------------------------------------
# Optional helpers
# -----------------------------------------------------------------------------
# Used by `pnpm init-drop` (tsx script), not by `make init-drop` (curl)
DROP_ID=

# You can point the backend .env loader somewhere else if needed
ENV_FILE=


